sequenceDiagram
    participant Admin
    participant UI as Admin Portal
    participant Traefik
    participant Excel as Excel Service
    participant Queue as Redis/BullMQ
    participant Worker as Excel Worker
    participant DB as MongoDB
    participant Progress as Progress Worker
    participant Cache as Redis Cache
    
    Admin->>UI: Upload Excel File
    UI->>Traefik: POST /api/excel/upload
    Traefik->>Excel: Forward Request
    Excel->>DB: Create Upload Session
    Excel->>Queue: Queue Processing Job
    Excel-->>UI: Return Job ID
    UI-->>Admin: Show Progress UI
    
    Queue->>Worker: Process Excel File
    Worker->>Worker: Parse Rows (Batch)
    loop For Each Batch
        Worker->>DB: Create Structural Elements
        Worker->>DB: Auto-create Jobs
    end
    
    Worker->>Queue: Trigger Progress Calculation
    Queue->>Progress: Calculate Statistics
    Progress->>DB: Update SubProject Stats
    Progress->>DB: Update Project Progress
    Progress->>Cache: Cache Progress Data
    
    Progress-->>Excel: Job Complete
    Excel-->>UI: WebSocket Update
    UI-->>Admin: Show Completion
